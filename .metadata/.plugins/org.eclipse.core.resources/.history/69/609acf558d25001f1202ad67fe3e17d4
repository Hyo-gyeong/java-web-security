// 컴퓨터학과, 20190975, 신효경
package key_manager;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.security.NoSuchAlgorithmException;

import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;

import enums.Algorithm;
import enums.FilePath;

public class CreateSaveSymmetricKey {
	
	private static void saveKeyToFile(SecretKey key, String fileName) throws IOException {
        try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(fileName))) {
            out.writeObject(key);
        }
    }
	
	public static void deleteDirectory(File directory) {
	    if (directory.exists()) {
	        File[] files = directory.listFiles();
	        if (files != null) {
	            for (File file : files) {
	            	file.delete(); // 파일 삭제
	            }
	        }
	    }
	}
	
	public static SecretKey createSymmetricKey() throws NoSuchAlgorithmException, IOException {
		KeyGenerator keyGen = KeyGenerator.getInstance(Algorithm.SK_ALGORITHM.getAlgorithm());
		keyGen.init(Integer.parseInt(Algorithm.SK_LENGTH.getAlgorithm()));
		SecretKey secretKey = keyGen.generateKey();
		saveKeyToFile(secretKey, FilePath.SK.getPath());
		
		return secretKey;
	}
}
